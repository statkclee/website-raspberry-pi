<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <title>xwMOOC: </title>
    <link rel="shortcut icon" type="image/x-icon" href="https://statkclee.github.io/website-raspberry-pi/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="http://statkclee.github.io/website-raspberry-pi/css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="http://statkclee.github.io/website-raspberry-pi/css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="http://statkclee.github.io/website-raspberry-pi/css/swc.css" />
    <!-- <link rel="alternate" type="application/rss+xml" title="Software Carpentry Blog" href="http://software-carpentry.org/feed.xml"/> -->
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
        <a href="http://www.xwmooc.net" title="xwMOOC 한글 컴퓨터 과학 언플러그드">
          <img alt="xwMOOC banner" src="http://statkclee.github.io/website-raspberry-pi/img/xwMOOC-logo.png" />
        </a>
      </div>
      <article>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
                    <h1 class="title"></h1>
          <h1 id="setting-up-a-chat-network-on-two-raspberry-pis">Setting up a chat network on two Raspberry Pis</h1>
<h2 id="student-worksheet">Student worksheet</h2>
<p>There are two steps to setting up the Raspberry Pis so you can send chat messages to each other: configuring the network and writing the program.</p>
<h2 id="network-configuration">Network configuration</h2>
<p>Before the Raspberry Pis can communicate they need to be connected together via a network. Normally, when a device connects to a network, it is assigned a unique identifier called an IP address. As we only have two Raspberry Pis, we have to give each Pi its own IP address.</p>
<ol style="list-style-type: decimal">
<li><p><a href="../rpi-static-ip-address.md">Follow this guide</a> to configure the IP address.</p></li>
<li><p>Repeat this procedure with your other Pi, giving this one the IP address <code>192.168.0.3</code>.</p></li>
</ol>
<p><strong>Tip:</strong> Use a Post-it note to physically label the Raspberry Pis with their IP addresses, otherwise things will get confusing later!</p>
<h3 id="testing-your-network">Testing your network</h3>
<ol style="list-style-type: decimal">
<li>Connect the two Pis with an Ethernet cable</li>
<li><p>On the Pi that has the IP address ending <code>.02</code>, type:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">ping</span> 192.168.0.3 -c5</code></pre></li>
</ol>
<p>You should see something like this:</p>
<pre><code>PING 192.168.0.3 (192.168.0.3) 56(84) bytes of data.
64 bytes from 192.168.0.3: icmp_req=1 ttl=128 time=3.46 ms
[...four more PINGs ...]

--- 192.168.0.3 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4007ms
rtt min/avg/max/mdev = 3.466/3.788/4.380/0.322 ms</code></pre>
<p>If not, check your edits and the network cable. Once the Raspberry Pis are successfully networked, you are ready to write the chat program.</p>
<h2 id="setting-up-the-chat-program">Setting up the chat program</h2>
<ol style="list-style-type: decimal">
<li>Create a new file with the nano editor by typing <code>nano chat.py</code>.</li>
<li><p>Type in the following program:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co"># A simple internet-chat application</span>

<span class="ch">import</span> network
<span class="ch">import</span> sys

<span class="kw">def</span> heard(phrase):
  <span class="dt">print</span>(<span class="st">&quot;them:&quot;</span> + phrase)

<span class="kw">if</span> (<span class="dt">len</span>(sys.argv) &gt;= <span class="dv">2</span>):
  network.call(sys.argv[<span class="dv">1</span>], whenHearCall=heard)
<span class="kw">else</span>:  
  network.wait(whenHearCall=heard)

<span class="kw">while</span> network.isConnected():
  <span class="co">#phrase = raw_input() #python2</span>
  phrase = <span class="dt">input</span>() <span class="co"># python3</span>
  <span class="dt">print</span>(<span class="st">&quot;me:&quot;</span> + phrase)
  network.say(phrase)</code></pre></li>
<li><p>Save the file with <code>CTRL-O</code> and then exit nano with <code>CTRL-X</code>.</p></li>
<li><p>Set the first Pi up as a <strong>server</strong> by typing:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">python</span> chat.py</code></pre></li>
<li><p>The second Pi will be the <strong>client</strong>. You need to tell it the IP address of the server that you want to connect to. For example, to connect to a Raspberry Pi that has the IP address ending in <code>.2.</code>, type:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">python</span> chat.py 192.168.0.2</code></pre></li>
<li><p>You should now be able to type messages on either Pi, and they will appear on the other screen when you press the <code>enter</code> key.</p></li>
</ol>
<p>Try it! Send messages from the server to the client and vice versa.</p>
<h3 id="things-to-think-about-when-sending-messages">Things to think about when sending messages:</h3>
<ul>
<li>What is happening on screen?</li>
<li>What is physically happening to the messages when you press the <code>enter</code> key?</li>
<li>How do the messages know where to go?</li>
</ul>
<h3 id="things-to-try">Things to try:</h3>
<ul>
<li>Can you break the program by sending messages too fast or at the same time?</li>
<li>What happens if you stop the server program by pressing <code>CTRL-C</code>?</li>
<li>Edit <code>chat.py</code> to change the ‘me:’ and ‘them:’ messages that appear to your own names.</li>
</ul>
<h3 id="programming-challenges">Programming challenges</h3>
<ul>
<li>Display a welcome message when your program starts.</li>
<li>Display a welcome message for your caller when they connect.</li>
<li>Display an increasing message counter for ‘me:’ and ‘them:’ on each message.</li>
<li>When you type in a certain letter or word, get the program to expand this to a whole sentence that is sent to your caller.</li>
<li>When the word “random” is typed, send one of a number of different random messages to your caller.</li>
<li>When certain words are received from your caller, automatically send a whole phrase back to them, with different phrases for different words.</li>
</ul>
<h2 id="cleanup">Cleanup</h2>
<p>If the teacher asks you to, change the network configuration back to a dynamic IP address as shown in the “Clean up” section of <a href="../rpi-static-ip-address.md">the guide</a>.</p>
        </div>
      </div>
      </article>
      <div class="footer">
        <a class="label swc-blue-bg" href="http://www.xwmooc.net">xwMOOC</a>
        <a class="label swc-blue-bg" href="https://github.com/statkclee/website-raspberry-pi/">Source</a>
        <a class="label swc-blue-bg" href="mailto:i@xwmooc.net">Contact</a>
        <a class="label swc-blue-bg" href="http://statkclee.github.io/website-raspberry-pi/LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="http://software-carpentry.org/v5/js/jquery-1.9.1.min.js"></script>
    <script src="https://statkclee.github.io/website-csunplugged/css/bootstrap/bootstrap-js/bootstrap.js"></script>
  </body>
</html>
